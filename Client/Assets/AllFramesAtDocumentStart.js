(()=>{var e={291:()=>{HTMLSelectElement.isInstance=e=>e instanceof HTMLSelectElement,HTMLInputElement.isInstance=e=>e instanceof HTMLInputElement,window.Cu={getWeakReference:e=>({get:()=>e})},HTMLElement.prototype.getAutocompleteInfo=function(){return{_reason:"autocomplete",fieldName:this.getAttribute("autocomplete")??""}}},204:()=>{"use strict";webkit.messageHandlers.trackingProtectionStats&&function(){let e=!0;Object.defineProperty(window.__firefox__,"TrackingProtectionStats",{enumerable:!1,configurable:!1,writable:!1,value:{}}),Object.defineProperty(window.__firefox__.TrackingProtectionStats,"setEnabled",{enumerable:!1,configurable:!1,writable:!1,value:function(t,n){n===APP_ID_TOKEN&&t!==e&&(e=t,c(t))}});let t=new Array,n=null;function r(r){if(e){try{if(document.location.host===new URL(r).host)return}catch(e){}r&&t.push(r),n||(n=setTimeout((()=>{n=null,t.length<1||(webkit.messageHandlers.trackingProtectionStats.postMessage({urls:t}),t=new Array)}),200))}}function i(){[].slice.apply(document.scripts).forEach((function(e){r(e.src)})),[].slice.apply(document.images).forEach((function(e){r(e.src)})),[].slice.apply(document.getElementsByTagName("iframe")).forEach((function(e){r(e.src)}))}let s=null,a=null,l=null,o=null,d=null;function c(e){if(!e)return window.removeEventListener("load",i,!1),void(s&&(XMLHttpRequest.prototype.open=s,XMLHttpRequest.prototype.send=a,window.fetch=l,d.disconnect(),s=a=o=d=null));if(!s){window.addEventListener("load",i,!1),s||(s=XMLHttpRequest.prototype.open,a=XMLHttpRequest.prototype.send);var t=new WeakMap;new WeakMap,XMLHttpRequest.prototype.open=function(e,n){return t.set(this,n),s.apply(this,arguments)},XMLHttpRequest.prototype.send=function(e){return r(t.get(this)),a.apply(this,arguments)},l||(l=window.fetch),window.fetch=function(e,t){return"string"==typeof e?r(e):e instanceof Request&&r(e.url),l.apply(window,arguments)},o||(o=Object.getOwnPropertyDescriptor(Image.prototype,"src")),delete Image.prototype.src,Object.defineProperty(Image.prototype,"src",{get:function(){return o.get.call(this)},set:function(e){r(this.src),o.set.call(this,e)}}),d=new MutationObserver((function(e){e.forEach((function(e){e.addedNodes.forEach((function(e){if("SCRIPT"===e.tagName&&e.src)r(e.src);else if("IMG"===e.tagName&&e.src)r(e.src);else if("IFRAME"===e.tagName&&e.src){if("about:blank"===e.src)return;r(e.src)}else"LINK"===e.tagName&&e.href&&r(e.href)}))}))})),d.observe(document.documentElement,{childList:!0,subtree:!0})}}c(!0)}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}(()=>{"use strict";window.__firefox__||Object.defineProperty(window,"__firefox__",{enumerable:!1,configurable:!1,writable:!1,value:{userScripts:{},includeOnce:function(e,t){return!!__firefox__.userScripts[e]||(__firefox__.userScripts[e]=!0,"function"==typeof t&&t(),!1)}}})})(),(()=>{"use strict";n(291);const e={FIELD_STATES:{NORMAL:"NORMAL",AUTO_FILLED:"AUTO_FILLED",PREVIEW:"PREVIEW"},FIELD_NAME_INFO:{name:"name","given-name":"name","additional-name":"name","family-name":"name",organization:"organization","street-address":"address","address-line1":"address","address-line2":"address","address-line3":"address","address-level1":"address","address-level2":"address","postal-code":"address",country:"address","country-name":"address",tel:"tel","tel-country-code":"tel","tel-national":"tel","tel-area-code":"tel","tel-local":"tel","tel-local-prefix":"tel","tel-local-suffix":"tel","tel-extension":"tel",email:"email","cc-name":"creditCard","cc-given-name":"creditCard","cc-additional-name":"creditCard","cc-family-name":"creditCard","cc-number":"creditCard","cc-exp-month":"creditCard","cc-exp-year":"creditCard","cc-exp":"creditCard","cc-type":"creditCard"},ELIGIBLE_INPUT_TYPES:["text","email","tel","number","month"],SECTION_TYPES:{ADDRESS:"address",CREDIT_CARD:"creditCard"},isAddressField(e){return!!this.FIELD_NAME_INFO[e]&&!this.isCreditCardField(e)},isCreditCardField(e){return"creditCard"==this.FIELD_NAME_INFO[e]},getCategoryFromFieldName(e){return this.FIELD_NAME_INFO[e]},getCategoriesFromFieldNames(e){let t=new Set;for(let n of e){let e=this.getCategoryFromFieldName(n);e&&t.add(e)}return Array.from(t)},isFieldVisible:e=>!e.hidden&&"none"!=e.style.display,isCreditCardOrAddressFieldType(e){if(!e)return!1;if(HTMLInputElement.isInstance(e)){if(!this.ELIGIBLE_INPUT_TYPES.includes(e.type))return!1;if(!this.isFieldVisible(e))return!1}else if(!HTMLSelectElement.isInstance(e))return!1;return!0},CC_FATHOM_NONE:0,CC_FATHOM_JS:1,CC_FATHOM_NATIVE:2,isFathomCreditCardsEnabled(e){return e!=this.CC_FATHOM_NONE},formAutofillConfidencesKeyToCCFieldType:e=>({ccNumber:"cc-number",ccName:"cc-name",ccType:"cc-type",ccExp:"cc-exp",ccExpMonth:"cc-exp-month",ccExpYear:"cc-exp-year"}[e])},t=Object.freeze(["amex","cartebancaire","diners","discover","jcb","mastercard","mir","unionpay","visa"]),r={"american express":"amex","master card":"mastercard","union pay":"unionpay"},i=[{type:"amex",start:34,end:34,len:15},{type:"amex",start:37,end:37,len:15},{type:"cartebancaire",start:4035,end:4035,len:16},{type:"cartebancaire",start:4360,end:4360,len:16},{type:"diners",start:300,end:305,len:[14,19]},{type:"diners",start:3095,end:3095,len:[14,19]},{type:"diners",start:36,end:36,len:[14,19]},{type:"diners",start:38,end:39,len:[14,19]},{type:"discover",start:6011,end:6011,len:[16,19]},{type:"discover",start:622126,end:622925,len:[16,19]},{type:"discover",start:624e3,end:626999,len:[16,19]},{type:"discover",start:628200,end:628899,len:[16,19]},{type:"discover",start:64,end:65,len:[16,19]},{type:"jcb",start:3528,end:3589,len:[16,19]},{type:"mastercard",start:2221,end:2720,len:16},{type:"mastercard",start:51,end:55,len:16},{type:"mir",start:2200,end:2204,len:16},{type:"unionpay",start:62,end:62,len:[16,19]},{type:"unionpay",start:81,end:81,len:[16,19]},{type:"visa",start:4,end:4,len:16}].sort(((e,t)=>t.start-e.start));class s{constructor({name:e,number:t,expirationString:n,expirationMonth:r,expirationYear:i,network:a,ccv:l,encryptedNumber:o}){this._name=e,this._unmodifiedNumber=t,this._encryptedNumber=o,this._ccv=l,this.number=t;let{month:d,year:c}=s.normalizeExpiration({expirationString:n,expirationMonth:r,expirationYear:i});this._expirationMonth=d,this._expirationYear=c,this.network=a}set name(e){this._name=e}set expirationMonth(e){this._expirationMonth=void 0!==e?s.normalizeExpirationMonth(e):void 0}get expirationMonth(){return this._expirationMonth}set expirationYear(e){this._expirationYear=void 0!==e?s.normalizeExpirationYear(e):void 0}get expirationYear(){return this._expirationYear}set expirationString(e){let{month:t,year:n}=s.parseExpirationString(e);this.expirationMonth=t,this.expirationYear=n}set ccv(e){this._ccv=e}get number(){return this._number}set number(e){if(e){let t=s.normalizeCardNumber(e);t=t.match(/^\d{12,}$/)?t:"",this._number=t}else this._number="";if(e&&!this.isValidNumber())throw this._number="",new Error("Invalid credit card number")}get network(){return this._network}set network(e){this._network=e||void 0}isValidNumber(){if(!this._number)return!1;let e=this._number.replace(/[\-\s]/g,""),t=e.length;if(t<12||t>19)return!1;if(!/^\d+$/.test(e))return!1;let n=0;for(let r=0;r<t;r++){let i=parseInt(e[t-r-1],10);r%2==1&&(i*=2,i>9&&(i-=9)),n+=i}return n%10==0}static normalizeCardNumber(e){return e?e.replace(/[\-\s]/g,""):null}static getType(e){for(let t=0;t<i.length;t++){const n=i[t];if("number"==typeof n.len){if(n.len!=e.length)continue}else if(e.length<n.len[0]||e.length>n.len[1])continue;const r=Math.floor(Math.log10(n.start))+1,s=parseInt(e.substring(0,r),10);if(s>=n.start&&s<=n.end)return n.type}return null}static getNetworkFromName(e){if(!e)return null;let n=e.trim().toLowerCase().normalize("NFKC");if(t.includes(n))return n;for(let e in r)if(n.includes(e))return r[e];return null}isValid(){if(!this.isValidNumber())return!1;let e=new Date,t=e.getFullYear();if(this._expirationYear>t)return!0;let n=e.getMonth()+1;return this._expirationYear==t&&this._expirationMonth>=n}get maskedNumber(){return s.getMaskedNumber(this._number)}get longMaskedNumber(){return s.getLongMaskedNumber(this._number)}static getLabelInfo({number:e,name:t,month:n,year:r,type:i}){let a=["number"];return t&&a.push("name"),n&&r&&a.push("expiration"),{id:`credit-card-label-${a.join("-")}-2`,args:{number:s.getMaskedNumber(e),name:t,month:n?.toString(),year:r?.toString(),type:i}}}static getLabel({number:e,name:t}){let n=[];return e&&n.push(s.getMaskedNumber(e)),t&&n.push(t),n.join(", ")}static normalizeExpirationMonth(e){if(e=parseInt(e,10),!(isNaN(e)||e<1||e>12))return e}static normalizeExpirationYear(e){if(e=parseInt(e,10),!(isNaN(e)||e<0))return e<100&&(e+=2e3),e}static parseExpirationString(e){let t=[{regex:/(?:^|\D)(\d{2})(\d{2})(?!\d)/},{regex:/(?:^|\D)(\d{4})[-/](\d{1,2})(?!\d)/,yearIndex:0,monthIndex:1},{regex:/(?:^|\D)(\d{1,2})[-/](\d{4})(?!\d)/,yearIndex:1,monthIndex:0},{regex:/(?:^|\D)(\d{1,2})[-/](\d{1,2})(?!\d)/},{regex:/(?:^|\D)(\d{2})(\d{2})(?!\d)/}];e=e.replaceAll(" ","");for(let n of t){let t,r,i=n.regex.exec(e);if(!i)continue;const s=[parseInt(i[1],10),parseInt(i[2],10)];if(n.yearIndex&&n.monthIndex?(t=s[n.yearIndex],r=s[n.monthIndex]):(r=s[0],r>12?(t=s[0],r=s[1]):t=s[1]),r>=1&&r<=12&&(t<100||t>2e3))return{month:r,year:t}}return{month:void 0,year:void 0}}static normalizeExpiration({expirationString:e,expirationMonth:t,expirationYear:n}){let r={};return!e||t&&n||(r=s.parseExpirationString(e)),{month:s.normalizeExpirationMonth(r.month||t),year:s.normalizeExpirationYear(r.year||n)}}static formatMaskedNumber(e){return{affix:"****",label:e.replace(/^\**/,"")}}static getCreditCardLogo(e){const t="chrome://formautofill/content/",n=t+"third-party/";switch(e){case"amex":return n+"cc-logo-amex.png";case"cartebancaire":return n+"cc-logo-cartebancaire.png";case"diners":return n+"cc-logo-diners.svg";case"discover":return n+"cc-logo-discover.png";case"jcb":return n+"cc-logo-jcb.svg";case"mastercard":return n+"cc-logo-mastercard.svg";case"mir":return n+"cc-logo-mir.svg";case"unionpay":return n+"cc-logo-unionpay.svg";case"visa":return n+"cc-logo-visa.svg";default:return t+"icon-credit-card-generic.svg"}}static getMaskedNumber(e){return"*".repeat(4)+" "+e.substr(-4)}static getLongMaskedNumber(e){return"*".repeat(e.length-4)+e.substr(-4)}static isValidNumber(e){try{new s({number:e})}catch(e){return!1}return!0}static isValidNetwork(e){return t.includes(e)}static getSupportedNetworks(){return t}static getNetworkL10nId(e){return this.isValidNetwork(e)?`autofill-card-network-${e}`:null}}const a={EXCLUDED_TAGS:["SCRIPT","NOSCRIPT","OPTION","STYLE"],_mappedLabels:null,_unmappedLabelControls:null,_labelStrings:new WeakMap,extractLabelStrings(e){if(this._labelStrings.has(e))return this._labelStrings.get(e);let t=[],n=e=>{if(!this.EXCLUDED_TAGS.includes(e.tagName))if(e.nodeType!=e.TEXT_NODE&&e.childNodes.length)for(let t of e.childNodes){let e=t.nodeType;e!=t.ELEMENT_NODE&&e!=t.TEXT_NODE||n(t)}else{let n=e.textContent.trim();n&&t.push(n)}};return n(e),this._labelStrings.set(e,t),t},generateLabelMap(e){this._mappedLabels=new Map,this._unmappedLabelControls=[],this._labelStrings=new WeakMap;for(let t of e.querySelectorAll("label")){let e,n=t.htmlFor;if(!n){if(e=t.control,!e)continue;n=e.id}if(n){let e=this._mappedLabels.get(n);e?e.push(t):this._mappedLabels.set(n,[t])}else this._unmappedLabelControls.push({label:t,control:e})}},clearLabelMap(){this._mappedLabels=null,this._unmappedLabelControls=null,this._labelStrings=null},findLabelElements(e){this._mappedLabels||this.generateLabelMap(e.ownerDocument);let t=e.id;return t?this._mappedLabels.get(t)||[]:this._unmappedLabelControls.filter((t=>t.control==e)).map((e=>e.label))}},l=()=>{},o={types:["cc-number","cc-name"]},d="-moz-section-default",c=["address-level3","address-level2","address-level1","tel","postal-code","email","street-address"],u={"cc-number":4};class m{constructor(e,{allowDuplicates:t=!1,sectionEnabled:n=!0}){this._elementsWeakRef=Cu.getWeakReference(e),this.fieldDetails=[],this._parsingIndex=0,this._sections=[],this._allowDuplicates=t,this._sectionEnabled=n}get _elements(){return this._elementsWeakRef.get()}get parsingIndex(){return this._parsingIndex}set parsingIndex(e){if(e>this._elements.length)throw new Error("The parsing index is out of range.");this._parsingIndex=e}getFieldDetailByIndex(e){if(e>=this._elements.length)throw new Error(`The index ${e} is out of range.(${this._elements.length})`);if(e<this.fieldDetails.length)return this.fieldDetails[e];for(let t=this.fieldDetails.length;t<e+1;t++)this.pushDetail();return this.fieldDetails[e]}get parsingFinished(){return this.parsingIndex>=this._elements.length}_pushToSection(e,t){for(let n of this._sections)if(n.name==e)return void n.fieldDetails.push(t);this._sections.push({name:e,fieldDetails:[t]})}_mergeNextNFields(e,t,n,r,i){if(e)e--;else{let s=u[t]-2,a=n.slice(r+1,r+1+s);a.length==s&&a.every((e=>e.fieldName==t))?e=s:i=!0}return{mergeNextNFields:e,createNewSection:i}}_classifySections(){let e=this._sections[0].fieldDetails;this._sections=[];let t,n=new Set,r=0,i=0;for(let s=0;s<e.length;s++){let a=e[s].fieldName;if(!a)continue;let l=!1;n.has(a)&&(t!=a?l=!0:c.includes(a)||(a in u?({mergeNextNFields:i,createNewSection:l}=this._mergeNextNFields(i,a,e,s,l)):l=!0)),l&&(i=0,n.clear(),r++),t=a,n.add(a),this._pushToSection("-moz-section-default-"+r,e[s])}}getSectionFieldDetails(){return this._sectionEnabled?this._sections.length?(1==this._sections.length&&this._sections[0].name==d&&this._classifySections(),this._sections.reduce(((e,t)=>(e.push(...this._getFinalDetails(t.fieldDetails)),e)),[])):[]:this._getFinalDetails(this.fieldDetails)}pushDetail(){let e=this.fieldDetails.length;if(e>=this._elements.length)throw new Error("Try to push the non-existing element info.");let t=this._elements[e],n=p.getInfo(t,this),r={section:n?.section??"",addressType:n?.addressType??"",contactType:n?.contactType??"",fieldName:n?.fieldName??"",confidence:n?.confidence,elementWeakRef:Cu.getWeakReference(t)};n?._reason&&(r._reason=n._reason),this.fieldDetails.push(r),this._pushToSection(this._getSectionName(r),r)}_getSectionName(e){let t=[];return e.section&&t.push(e.section),e.addressType&&t.push(e.addressType),t.length?t.join(" "):d}updateFieldName(e,t){if(e>=this.fieldDetails.length)throw new Error("Try to update the non-existing field detail.");this.fieldDetails[e].fieldName=t}_isSameField(e,t){return e.section==t.section&&e.addressType==t.addressType&&e.fieldName==t.fieldName&&!e.transform&&!t.transform}_transformCCNumberForMultipleFields(e){let t=e.filter((e=>"cc-number"==e.fieldName&&4==e.elementWeakRef.get().maxLength));4==t.length&&(t[0].transform=e=>e.slice(0,4),t[1].transform=e=>e.slice(4,8),t[2].transform=e=>e.slice(8,12),t[3].transform=e=>e.slice(12,16))}_getFinalDetails(t){let n=[],r=[];for(let i of t){let t=i.fieldName;e.isAddressField(t)?n.push(i):e.isCreditCardField(t)?r.push(i):l("Not collecting a field with a unknown fieldName",i)}return this._transformCCNumberForMultipleFields(r),[{type:e.SECTION_TYPES.ADDRESS,fieldDetails:n},{type:e.SECTION_TYPES.CREDIT_CARD,fieldDetails:r}].map((e=>{if(this._allowDuplicates)return e;let t=e.fieldDetails;return e.fieldDetails=t.filter(((e,n)=>!t.slice(0,n).find((t=>this._isSameField(e,t))))),e})).filter((e=>!!e.fieldDetails.length))}elementExisting(e){return e<this._elements.length}getFathomField(e,t){if(!t.length)return[null,null];if(!this._fathomConfidences?.get(e)){this._fathomConfidences=new Map;let t=[];t=this._elements?.includes(e)?this._elements:[e];let n=m.getFormAutofillConfidences(t);for(let e=0;e<t.length;e++)this._fathomConfidences.set(t[e],n[e])}let n=this._fathomConfidences.get(e);if(!n)return[null,null];let r=null,i=.5;for(let[e,s]of Object.entries(n))t.includes(e)&&s>i&&(i=s,r=e);return r?(i=.5,[r,i]):[null,null]}static getFormAutofillConfidences(t){return 1==e.CC_FATHOM_NATIVE?ChromeUtils.getFormAutofillConfidences(t).map((t=>{let n={};for(let[r,i]of Object.entries(t))n[e.formAutofillConfidencesKeyToCCFieldType(r)]=i;return n})):t.map((e=>{let t={};return o.types.map((n=>{t[n]=function(t){const n=o[t].against(e).get(t);return n.length?n[0].scoreFor(t):0}(n)})),t}))}}const f={types:["cc-number","cc-name"]},p={RULES:null,CREDIT_CARD_FIELDNAMES:[],ADDRESS_FIELDNAMES:[],_matchContiguousSubArray:(e,t)=>e.some(((n,r)=>t.every(((t,n)=>t==e[r+n])))),_isExpirationMonthLikely(e){if(!HTMLSelectElement.isInstance(e))return!1;const t=[...e.options],n=Array(12).fill(1).map(((e,t)=>e+t));return!(t.length<12||t.length>13)&&(this._matchContiguousSubArray(t.map((e=>+e.value)),n)||this._matchContiguousSubArray(t.map((e=>+e.label)),n))},_isExpirationYearLikely(e){if(!HTMLSelectElement.isInstance(e))return!1;const t=[...e.options],n=(new Date).getFullYear(),r=Array(3).fill(0).map(((e,t)=>e+n+t));return this._matchContiguousSubArray(t.map((e=>+e.value)),r)||this._matchContiguousSubArray(t.map((e=>+e.label)),r)},_parsePhoneFields(t){let n;const r=this.PHONE_FIELD_GRAMMARS;for(let e=0;e<r.length;e++){let i=t.parsingIndex,s=e;for(;e<r.length&&r[e][0]&&t.elementExisting(i);e++,i++){let n=t.getFieldDetailByIndex(i);if(!n||r[e][0]!=n.fieldName||n._reason&&"autocomplete"==n._reason)break;let s=n.elementWeakRef.get();if(!s)break;if(r[e][2]&&(!s.maxLength||r[e][2]<s.maxLength))break}if(e>=r.length)break;if(!r[e][0]){n={ruleFrom:s,ruleTo:e};break}for(;e<r.length&&r[e][0];e++);}let i=!1;if(n){let{ruleFrom:e,ruleTo:s}=n,a=t.parsingIndex;for(let n=e;n<s;n++)t.updateFieldName(a,r[n][1]),t.parsingIndex++,a++,i=!0}if(t.parsingFinished)return i;let s=t.getFieldDetailByIndex(t.parsingIndex);if(s&&"autocomplete"!=s._reason&&t.parsingIndex>0){const n=new RegExp("\\bext|ext\\b|extension|ramal","iu"),r=t.getFieldDetailByIndex(t.parsingIndex-1),a=e.getCategoryFromFieldName(r.fieldName);r&&"tel"==a&&this._matchRegexp(s.elementWeakRef.get(),n)&&(t.updateFieldName(t.parsingIndex,"tel-extension"),t.parsingIndex++,i=!0)}return i},_parseAddressFields(e){let t=!1;const n=["address-line1","address-line2","address-line3"],r={"address-line1":new RegExp("address[_-]?line(1|one)|address1|addr1|addrline1|address_1|indirizzo1|住所1|地址1|주소.?1","iu"),"address-line2":new RegExp("address[_-]?line(2|two)|address2|addr2|addrline2|address_2|indirizzo2|住所2|地址2|주소.?2","iu"),"address-line3":new RegExp("address[_-]?line(3|three)|address3|addr3|addrline3|address_3|indirizzo3|住所3|地址3|주소.?3","iu")};for(;!e.parsingFinished;){let i=e.getFieldDetailByIndex(e.parsingIndex);if(!i||!n.includes(i.fieldName)||"autocomplete"==i._reason)break;const s=i.elementWeakRef.get();for(let n of Object.keys(r))this._matchRegexp(s,r[n])&&(e.updateFieldName(e.parsingIndex,n),t=!0);e.parsingIndex++}return t},_parseCreditCardFields(t){if(t.parsingFinished)return!1;const n=t.parsingIndex,r=t.getFieldDetailByIndex(t.parsingIndex);if(!r||r._reason&&"autocomplete"==r._reason)return!1;if(!["cc-exp","cc-type","cc-exp-month","cc-exp-year"].includes(r.fieldName))return!1;if(e.isFathomCreditCardsEnabled()&&f.types.includes(r.fieldName))return t.parsingIndex++,!0;const i=r.elementWeakRef.get();if(HTMLSelectElement.isInstance(i))for(let e of i.querySelectorAll("option"))if(s.getNetworkFromName(e.value)||s.getNetworkFromName(e.text))return t.updateFieldName(t.parsingIndex,"cc-type"),t.parsingIndex++,!0;if("month"==i.type)return t.updateFieldName(t.parsingIndex,"cc-exp"),t.parsingIndex++,!0;if("cc-exp-month"==t.getFieldDetailByIndex(t.parsingIndex++).fieldName&&!t.parsingFinished&&"cc-exp-year"==t.getFieldDetailByIndex(t.parsingIndex++).fieldName)return!0;if(t.parsingIndex=n,this._isExpirationMonthLikely(i)&&(t.updateFieldName(t.parsingIndex,"cc-exp-month"),t.parsingIndex++,!t.parsingFinished)){const e=t.getFieldDetailByIndex(t.parsingIndex).elementWeakRef.get();if(this._isExpirationYearLikely(e))return t.updateFieldName(t.parsingIndex,"cc-exp-year"),t.parsingIndex++,!0}if(t.parsingIndex=n,this._findMatchedFieldName(i,["cc-exp-month"])&&(t.updateFieldName(t.parsingIndex,"cc-exp-month"),t.parsingIndex++,!t.parsingFinished)){const e=t.getFieldDetailByIndex(t.parsingIndex).elementWeakRef.get();if(this._findMatchedFieldName(e,["cc-exp-year"]))return t.updateFieldName(t.parsingIndex,"cc-exp-year"),t.parsingIndex++,!0}if(t.parsingIndex=n,this._matchRegexp(i,/^mm$/gi)&&(t.updateFieldName(t.parsingIndex,"cc-exp-month"),t.parsingIndex++,!t.parsingFinished)){const e=t.getFieldDetailByIndex(t.parsingIndex).elementWeakRef.get();if(this._matchRegexp(e,/^(yy|yyyy)$/))return t.updateFieldName(t.parsingIndex,"cc-exp-year"),t.parsingIndex++,!0}return t.parsingIndex=n,this._matchRegexp(i,/(?:exp.*date[^y\\n\\r]*|mm\\s*[-/]?\\s*)yy(?:[^y]|$)/gi)||this._matchRegexp(i,/(?:exp.*date[^y\\n\\r]*|mm\\s*[-/]?\\s*)yyyy(?:[^y]|$)/gi)?(t.updateFieldName(t.parsingIndex,"cc-exp"),t.parsingIndex++,!0):(t.parsingIndex=n,this._findMatchedFieldName(i,["cc-exp"])?(t.updateFieldName(t.parsingIndex,"cc-exp"),t.parsingIndex++,!0):(t.parsingIndex=n,t.updateFieldName(t.parsingIndex,null),t.parsingIndex++,!0))},getFormInfo(t,n=!1){const r=Array.from(t.elements).filter((t=>e.isCreditCardOrAddressFieldType(t)));if(r.length<=0)return[];let i=new m(r,{allowDuplicates:n,sectionEnabled:this._sectionEnabled});for(;!i.parsingFinished;){let e=this._parsePhoneFields(i),t=this._parseAddressFields(i),n=this._parseCreditCardFields(i);e||t||n||i.parsingIndex++}return a.clearLabelMap(),i.getSectionFieldDetails()},_getPossibleFieldNames(e){let t=[],n="off"==e.autocomplete||"off"==e.form?.autocomplete;if(n||t.push(...this.CREDIT_CARD_FIELDNAMES),n||t.push(...this.ADDRESS_FIELDNAMES),HTMLSelectElement.isInstance(e)){const e=["address-level1","address-level2","country","cc-exp-month","cc-exp-year","cc-exp","cc-type"];t=t.filter((t=>e.includes(t)))}return t},getInfo(t,n){function r(e,t=null){return{fieldName:e,section:"",addressType:"",contactType:"",confidence:t}}let i=t.getAutocompleteInfo();if(i&&i.fieldName&&"on"!=i.fieldName&&"off"!=i.fieldName)return i._reason="autocomplete",i;if(!this._prefEnabled)return null;let s=this._getPossibleFieldNames(t);if("email"==t.type&&s.includes("email"))return r("email");if(e.isFathomCreditCardsEnabled()){let e=s.filter((e=>f.types.includes(e))),[i,a]=n.getFathomField(t,e);if(i)return r(i,a)}if(s.length){let e=this._findMatchedFieldName(t,s);if(e)return r(e)}return null},_getElementStrings:e=>({*[Symbol.iterator](){yield e.id,yield e.name,yield e.placeholder?.trim();const t=a.findLabelElements(e);for(let e of t)yield*a.extractLabelStrings(e)}}),_findMatchedFieldName(e,t){const n=this._getElementStrings(e);for(let e of t)for(let t of n)if(this.RULES[e].test(t?.toLowerCase()))return e;return null},_matchRegexp(e,t){const n=this._getElementStrings(e);for(const e of n)if(t.test(e))return!0;return!1},PHONE_FIELD_GRAMMARS:[["tel","tel-country-code",3],["tel","tel-area-code",3],["tel","tel-local-prefix",3],["tel","tel-local-suffix",4],[null,null,0],["tel","tel-area-code",0],["tel","tel-local-prefix",3],["tel","tel-local-suffix",4],[null,null,0]]};class h{constructor(){this.creditCardSections=[]}findForms(e){for(var t=0;t<e.length;t++){var n=e[t];"FORM"===n.nodeName?this.findCreditCardForms(n):n.hasChildNodes()&&this.findForms(n.childNodes)}return!1}findCreditCardForms(t){const n=p.getFormInfo(t).filter((t=>t.type==e.SECTION_TYPES.CREDIT_CARD)).map((e=>e.fieldDetails)),r=n.flatMap((e=>e.map(this.getFieldRef)));return this.creditCardSections.push(...n),r}getFieldRef(e){return e.elementWeakRef.get()}getSectionId(e){const t=(e,t)=>e.some((e=>this.getFieldRef(e)===t));return this.creditCardSections.findIndex((n=>t(n,e)))}fillCCFormFields(e,t){for(let n of e){const e=this.getFieldRef(n);n.fieldName in t&&(e.value=t[n.fieldName])}}fillCreditCardInfo(e){const{id:t,data:n}=JSON.parse(e);this.fillCCFormFields(this.creditCardSections?.[t],n)}}Object.defineProperty(window.__firefox__,"CreditCardHelper",{enumerable:!1,configurable:!1,writable:!1,value:Object.freeze(new class{constructor(){this.onLoad=this.onLoad.bind(this),this.onFocus=this.onFocus.bind(this),this.creditCardAutofill=new h,window.addEventListener("load",this.onLoad)}onLoad(){new MutationObserver((e=>{for(var t=0;t<e.length;++t)this.findForms(e[t].addedNodes)})).observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),[...document.forms].forEach((e=>{this.creditCardAutofill.findCreditCardForms(e).forEach((e=>e.addEventListener("focus",this.onFocus)))}))}onFocus(e){this.sendMessage({msg:"cc-form",id:this.creditCardAutofill.getSectionId(e.target)})}sendMessage(e){window.webkit.messageHandlers.creditCardMessageHandler?.postMessage(e)}fillCreditCardInfo(e){this.creditCardAutofill.fillCreditCardInfo(e)}})})})(),(()=>{"use strict";void 0===window.__firefox__.download&&Object.defineProperty(window.__firefox__,"download",{enumerable:!1,configurable:!1,writable:!1,value:function(e,t){if(t===APP_ID_TOKEN){if(e.startsWith("blob:")){var n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType="blob",n.onload=function(){if(200===this.status){var t=this.response;!function(e,t){var n=new FileReader;n.onloadend=function(){t(this.result.split(",")[1])},n.readAsDataURL(e)}(t,(function(n){webkit.messageHandlers.downloadManager.postMessage({url:e,mimeType:t.type,size:t.size,base64String:n})}))}},void n.send()}var r=document.createElement("a");r.href=e,r.dispatchEvent(new MouseEvent("click"))}}})})(),(()=>{"use strict";window.__firefox__.includeOnce("LoginsHelper",(function(){function e(e){}var t={_getRandomId:function(){return Math.round(Math.random()*(Number.MAX_VALUE-Number.MIN_VALUE)+Number.MIN_VALUE).toString()},_messages:["RemoteLogins:loginsFound"],_requests:{},_takeRequest:function(e){var t=e,n=this._requests[t.requestId];return this._requests[t.requestId]=void 0,n},_sendRequest:function(e,t){var n=this._getRandomId();t.requestId=n,webkit.messageHandlers.loginsManagerMessageHandler.postMessage(t);var r=this;return new Promise((function(t,i){e.promise={resolve:t,reject:i},r._requests[n]=e}))},receiveMessage:function(e){var t=this._takeRequest(e);switch(e.name){case"RemoteLogins:loginsFound":t.promise.resolve({form:t.form,loginsFound:e.logins});break;case"RemoteLogins:loginsAutoCompleted":t.promise.resolve(e.logins)}},_asyncFindLogins:function(e,t){var i=this._getFormFields(e,!1);if(!i[0]||!i[1])return Promise.reject("No logins found");i[0].addEventListener("blur",r);var s=n._getPasswordOrigin(e.ownerDocument.documentURI),a=n._getActionOrigin(e);if(null==a)return Promise.reject("Action origin is null");var l={form:e},o={type:"request",formOrigin:s,actionOrigin:a};return this._sendRequest(l,o)},loginsFound:function(e,t){this._fillForm(e,!0,!1,!1,!1,t)},onUsernameInput:function(t){var n=t.target;if(n.ownerDocument instanceof HTMLDocument&&this._isUsernameFieldType(n)){var r=n.form;if(r&&n.value){t.type;var[i,s,a]=this._getFormFields(r,!1);if(i==n&&s){var l=this;this._asyncFindLogins(r,{showMasterPassword:!1}).then((function(e){l._fillForm(e.form,!0,!0,!0,!0,e.loginsFound)})).then(null,e)}}}},_getPasswordFields:function(e,t){for(var n=[],r=0;r<e.elements.length;r++){var i=e.elements[r];i instanceof HTMLInputElement&&"password"==i.type&&(t&&!i.value||(n[n.length]={index:r,element:i}))}return 0==n.length?null:n.length>3?(n.length,null):n},_isUsernameFieldType:function(e){return e instanceof HTMLInputElement&&!!class{static inputTypeIsCompatibleWithUsername(e){const t=e.getAttribute("type")?.toLowerCase()||e.type;return"text"==t||"email"==t||"url"==t||"tel"==t||"number"==t||"search"==t}static elementAttrsMatchRegex(e,t){if(t.test(e.id)||t.test(e.name)||t.test(e.className))return!0;const n=e.getAttribute("placeholder");return n&&t.test(n)}static hasLabelMatchingRegex(e,t){return t.test(e.labels?.[0]?.textContent)}}.inputTypeIsCompatibleWithUsername(e)},_getFormFields:function(e,t){var n,r,i=null,s=this._getPasswordFields(e,t);if(!s)return[null,null,null];for(var a=s[0].index-1;a>=0;a--){var l=e.elements[a];if(this._isUsernameFieldType(l)){i=l;break}}if(!t||1==s.length)return[i,s[0].element,null];var o=s[0].element.value,d=s[1].element.value,c=s[2]?s[2].element.value:null;if(3==s.length)if(o==d&&d==c)r=s[0].element,n=null;else if(o==d)r=s[0].element,n=s[2].element;else if(d==c)n=s[0].element,r=s[2].element;else{if(o!=c)return[null,null,null];r=s[0].element,n=s[1].element}else o==d?(r=s[0].element,n=null):(n=s[0].element,r=s[1].element);return[i,r,n]},_isAutocompleteDisabled:function(e){return!(!e||!e.hasAttribute("autocomplete")||"off"!=e.getAttribute("autocomplete").toLowerCase())},_onFormSubmit:function(e){var t=e.ownerDocument,r=t.defaultView,i=n._getPasswordOrigin(t.documentURI);if(i){var s=n._getActionOrigin(e),a=this._getFormFields(e,!0),l=a[0],o=a[1],d=a[2];if(null!=o){this._isAutocompleteDisabled(e)||this._isAutocompleteDisabled(l)||this._isAutocompleteDisabled(o)||this._isAutocompleteDisabled(d);var c=l?{name:l.name,value:l.value}:null,u={name:o.name,value:o.value};d&&(d.name,d.value),r.opener&&r.opener.top,webkit.messageHandlers.loginsManagerMessageHandler.postMessage({type:"submit",hostname:i,username:c.value,usernameField:c.name,password:u.value,passwordField:u.name,formSubmitUrl:s})}}},_fillForm:function(e,t,n,r,i,s){var a=this._getFormFields(e,!1),o=a[0],d=a[1];if(null==d)return[!1,s];if(d.disabled||d.readOnly)return[!1,s];var c=Number.MAX_VALUE,u=Number.MAX_VALUE;o&&o.maxLength>=0&&(c=o.maxLength),d.maxLength>=0&&(u=d.maxLength),s=function(e,t){var n,r,i;if(null==e)throw new TypeError("Array is null or not defined");var s=Object(e),a=s.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(n=e),r=new Array(a),i=0;i<a;){var l,o;i in s&&(l=s[i],o=t.call(n,l,i,s),r[i]=o),i++}return r}(s,(function(e){return{hostname:e.hostname,formSubmitUrl:e.formSubmitUrl,httpRealm:e.httpRealm,username:e.username,password:e.password,usernameField:e.usernameField,passwordField:e.passwordField}}));var m=s.filter((function(e){var t=e.username.length<=c&&e.password.length<=u;return t||e.username,t}),this);if(0==m.length)return[!1,s];if(d.value&&!r)return[!1,s];var f=!1;!n&&(this._isAutocompleteDisabled(e)||this._isAutocompleteDisabled(o)||this._isAutocompleteDisabled(d))&&(f=!0);var p=null;if(o&&(o.value||o.disabled||o.readOnly)){var h=o.value.toLowerCase(),g=m.filter((function(e){return e.username.toLowerCase()==h}));if(g.length){for(var _=0;_<g.length;_++){var x=g[_];x.username==o.value&&(p=x)}p||(p=g[0])}}else 1==m.length?p=m[0]:(g=o?m.filter((function(e){return e.username})):m.filter((function(e){return!e.username})),p=g[0]);var y=!1;if(p&&t&&!f){if(o){var b=o.disabled||o.readOnly,F=p.username!=o.value,I=i&&F&&o.value.toLowerCase()==p.username.toLowerCase();b||I||!F||(o.value=p.username,l(o,"keydown",40),l(o,"keyup",40),document.activeElement!==o&&o.dispatchEvent(new Event("change")))}d.value!=p.password&&(d.value=p.password,l(d,"keydown",40),l(d,"keyup",40),document.activeElement!==d&&d.dispatchEvent(new Event("change"))),y=!0}return[y,s]}},n={_getPasswordOrigin:function(e,t){return e},_getActionOrigin:function(e){var t=e.action;return""==t&&(t=e.baseURI),this._getPasswordOrigin(t,!0)}};function r(e){t.onUsernameInput(e)}var i=new MutationObserver((function(e){for(var t=0;t<e.length;++t)s(e[t].addedNodes)}));function s(e){for(var t=0;t<e.length;t++){var n=e[t];"FORM"===n.nodeName?a(n):n.hasChildNodes()&&s(n.childNodes)}return!1}function a(n){try{t._asyncFindLogins(n,{}).then((function(e){t.loginsFound(e.form,e.loginsFound)})).then(null,e)}catch(e){}}function l(e,t,n){var r=document.createEvent("KeyboardEvent");r.initKeyboardEvent(t,!0,!0,window,0,0,0,0,0,n),e.dispatchEvent(r)}window.addEventListener("load",(function(e){i.observe(document.body,{attributes:!1,childList:!0,characterData:!1,subtree:!0});for(var t=0;t<document.forms.length;t++)a(document.forms[t])})),window.addEventListener("submit",(function(e){try{t._onFormSubmit(e.target)}catch(e){}})),Object.defineProperty(window.__firefox__,"logins",{enumerable:!1,configurable:!1,writable:!1,value:Object.freeze(new function(){this.inject=function(e){try{t.receiveMessage(e)}catch(e){}}})})}))})(),(()=>{"use strict";n(204)})()})();